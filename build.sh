#/bin/bash

echo "================================================================================================"
echo "[*] INSTALACION DE DEPENDENCIAS DE COMPILACION"
echo "================================================================================================"
echo ""
pip install build
echo ""
echo "================================================================================================"
echo  "[*] HISTORIAL DE CAMBIOS"
echo "================================================================================================"
echo ""
cat CHANGES
echo ""
if [ -z "$1" ]
then
    archivo="CPCReady/__init__.py"
    version=$(grep -o "__version__ = '[0-9]\+\.[0-9]\+\.[0-9]\+'" "$archivo")
    version=$(echo "$version" | sed "s/__version__ = '//;s/'//")
    echo "================================================================================================"
    echo  "[*] NO PASAMOS VERSION. COMPILAMOS CON LA ACTUAL $version"
    echo "================================================================================================"
else
    echo "__version__ = '$1'" > "CPCReady/__init__.py"
    # git tag $version -m "Primera versi√≥n"
    echo "================================================================================================"
    echo "[*] COMPILAMOS SOFTWARE CON NUEVA VERSION $1"
    echo "================================================================================================"
    echo $CHANGES

fi

python3 -m build
